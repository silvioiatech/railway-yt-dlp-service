<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Downloader">

    <title>Ultimate Downloader - Mobile</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <style>
        /* Mobile-optimized styles */
        @supports(padding: max(0px)) {
            .safe-area-top {
                padding-top: max(env(safe-area-inset-top), 16px);
            }
            .safe-area-bottom {
                padding-bottom: max(env(safe-area-inset-bottom), 16px);
            }
        }

        /* Touch feedback */
        .touch-feedback:active {
            transform: scale(0.95);
            opacity: 0.8;
        }

        /* Bottom sheet */
        .bottom-sheet {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-radius: 24px 24px 0 0;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            max-height: 85vh;
            overflow-y: auto;
        }

        .bottom-sheet.active {
            transform: translateY(0);
        }

        .bottom-sheet-handle {
            width: 40px;
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            margin: 12px auto;
        }

        /* Swipe indicator */
        .swipe-indicator {
            animation: swipe 2s ease-in-out infinite;
        }

        @keyframes swipe {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(-8px); }
        }

        /* Pull to refresh */
        .pull-to-refresh {
            position: relative;
            padding-top: 60px;
            margin-top: -60px;
        }

        /* Floating action button */
        .fab {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 40;
        }
    </style>
</head>
<body class="h-full bg-gray-50 overflow-x-hidden" x-data="mobileApp()">

    <!-- Status Bar Spacer -->
    <div class="safe-area-top"></div>

    <!-- Header - Compact -->
    <header class="sticky top-0 z-50 bg-white border-b border-gray-200">
        <div class="px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <div class="text-2xl">⚡</div>
                    <div>
                        <h1 class="text-sm font-bold text-gray-900">Downloader</h1>
                        <p class="text-xs text-gray-500">1000+ platforms</p>
                    </div>
                </div>
                <button
                    @click="showMenu = true"
                    class="p-2 rounded-lg active:bg-gray-100 touch-feedback"
                >
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="pb-24">

        <!-- Quick Paste Bar -->
        <div class="p-4 bg-gradient-to-r from-indigo-500 to-purple-600">
            <div class="flex items-center space-x-3 bg-white/20 backdrop-blur-sm rounded-xl p-4 text-white">
                <svg class="w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                </svg>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium">Paste your link here</p>
                    <p class="text-xs opacity-90">YouTube, TikTok, Twitter...</p>
                </div>
                <button
                    @click="pasteFromClipboard()"
                    class="px-4 py-2 bg-white text-indigo-600 rounded-lg font-semibold text-sm touch-feedback"
                >
                    Paste
                </button>
            </div>
        </div>

        <!-- URL Input (Expanded when has content) -->
        <div
            x-show="url"
            x-transition
            class="p-4 bg-white border-b border-gray-200"
        >
            <div class="relative">
                <input
                    type="text"
                    x-model="url"
                    placeholder="https://..."
                    class="w-full px-4 py-3 pr-10 text-base rounded-lg border-2 border-gray-300 focus:border-indigo-500 focus:ring-0 outline-none"
                >
                <button
                    @click="url = ''"
                    class="absolute right-2 top-1/2 -translate-y-1/2 p-2 rounded-lg active:bg-gray-100 touch-feedback"
                >
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Quick Actions -->
        <div
            x-show="url"
            x-transition
            class="p-4 space-y-3"
        >
            <!-- Download Button - Primary -->
            <button
                @click="quickDownload()"
                class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl shadow-lg active:scale-95 transition-transform touch-feedback flex items-center justify-center space-x-2"
            >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                </svg>
                <span>Download Now</span>
            </button>

            <!-- Secondary Actions Grid -->
            <div class="grid grid-cols-2 gap-3">
                <button
                    @click="getInfo()"
                    class="py-3 bg-white border-2 border-gray-300 rounded-xl font-semibold text-gray-700 active:bg-gray-50 touch-feedback"
                >
                    <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Info
                </button>

                <button
                    @click="showOptions = true"
                    class="py-3 bg-white border-2 border-gray-300 rounded-xl font-semibold text-gray-700 active:bg-gray-50 touch-feedback"
                >
                    <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
                    </svg>
                    Options
                </button>
            </div>
        </div>

        <!-- Active Downloads -->
        <div
            x-show="activeDownloads.length > 0"
            class="p-4"
        >
            <h2 class="text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3">Active Downloads</h2>
            <div class="space-y-3">
                <template x-for="download in activeDownloads" :key="download.id">
                    <div class="bg-white rounded-xl p-4 shadow-sm border border-gray-200">
                        <!-- Title -->
                        <h3 class="font-semibold text-gray-900 mb-1 truncate" x-text="download.title"></h3>
                        <p class="text-xs text-gray-500 mb-3" x-text="download.status"></p>

                        <!-- Progress -->
                        <div class="mb-3">
                            <div class="flex items-center justify-between text-xs text-gray-600 mb-1">
                                <span x-text="download.progress + '%'"></span>
                                <span x-text="download.speed"></span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div
                                    class="h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all"
                                    :style="`width: ${download.progress}%`"
                                ></div>
                            </div>
                        </div>

                        <!-- Actions -->
                        <div class="flex items-center space-x-2">
                            <button
                                @click="pauseDownload(download.id)"
                                class="flex-1 py-2 bg-yellow-50 text-yellow-700 rounded-lg font-medium text-sm touch-feedback"
                            >
                                Pause
                            </button>
                            <button
                                @click="cancelDownload(download.id)"
                                class="flex-1 py-2 bg-red-50 text-red-700 rounded-lg font-medium text-sm touch-feedback"
                            >
                                Cancel
                            </button>
                        </div>
                    </div>
                </template>
            </div>
        </div>

        <!-- Recent Downloads -->
        <div
            x-show="recentDownloads.length > 0"
            class="p-4"
        >
            <h2 class="text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3">Recent</h2>
            <div class="space-y-2">
                <template x-for="download in recentDownloads" :key="download.id">
                    <div class="bg-white rounded-xl p-4 shadow-sm border border-gray-200 flex items-center space-x-3">
                        <!-- Icon -->
                        <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>

                        <!-- Info -->
                        <div class="flex-1 min-w-0">
                            <h3 class="font-semibold text-gray-900 truncate text-sm" x-text="download.title"></h3>
                            <p class="text-xs text-gray-500" x-text="download.size + ' • ' + download.time"></p>
                        </div>

                        <!-- Download -->
                        <button
                            @click="openFile(download.url)"
                            class="p-2 bg-indigo-50 text-indigo-600 rounded-lg touch-feedback"
                        >
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                            </svg>
                        </button>
                    </div>
                </template>
            </div>
        </div>

        <!-- Empty State -->
        <div
            x-show="!url && activeDownloads.length === 0 && recentDownloads.length === 0"
            class="p-8 text-center"
        >
            <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-10 h-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">No downloads yet</h3>
            <p class="text-sm text-gray-500 mb-4">Paste a video URL to get started</p>
            <button
                @click="pasteFromClipboard()"
                class="px-6 py-3 bg-indigo-600 text-white rounded-lg font-semibold touch-feedback"
            >
                Paste from Clipboard
            </button>
        </div>

    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 safe-area-bottom z-50">
        <div class="grid grid-cols-4 h-16">
            <button
                @click="currentTab = 'home'"
                :class="currentTab === 'home' ? 'text-indigo-600' : 'text-gray-400'"
                class="flex flex-col items-center justify-center space-y-1 touch-feedback"
            >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                </svg>
                <span class="text-xs font-medium">Home</span>
            </button>

            <button
                @click="currentTab = 'downloads'"
                :class="currentTab === 'downloads' ? 'text-indigo-600' : 'text-gray-400'"
                class="flex flex-col items-center justify-center space-y-1 touch-feedback"
            >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                </svg>
                <span class="text-xs font-medium">Downloads</span>
            </button>

            <button
                @click="currentTab = 'history'"
                :class="currentTab === 'history' ? 'text-indigo-600' : 'text-gray-400'"
                class="flex flex-col items-center justify-center space-y-1 touch-feedback"
            >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span class="text-xs font-medium">History</span>
            </button>

            <button
                @click="currentTab = 'settings'"
                :class="currentTab === 'settings' ? 'text-indigo-600' : 'text-gray-400'"
                class="flex flex-col items-center justify-center space-y-1 touch-feedback"
            >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <span class="text-xs font-medium">Settings</span>
            </button>
        </div>
    </nav>

    <!-- Options Bottom Sheet -->
    <div
        x-show="showOptions"
        @click.self="showOptions = false"
        class="fixed inset-0 bg-black/50 z-50"
        x-transition:enter="transition-opacity ease-out duration-300"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
    >
        <div
            class="bottom-sheet"
            :class="{ 'active': showOptions }"
        >
            <div class="bottom-sheet-handle"></div>

            <div class="px-4 pb-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4">Download Options</h2>

                <!-- Quality -->
                <div class="mb-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-3">Quality</label>
                    <div class="grid grid-cols-2 gap-2">
                        <template x-for="q in ['Best', '1080p', '720p', '480p', 'Audio']" :key="q">
                            <button
                                @click="quality = q"
                                :class="quality === q ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-700'"
                                class="py-3 rounded-lg font-medium touch-feedback"
                                x-text="q"
                            ></button>
                        </template>
                    </div>
                </div>

                <!-- Format -->
                <div class="mb-6">
                    <label class="block text-sm font-semibold text-gray-700 mb-3">Format</label>
                    <select class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 bg-white">
                        <option>MP4 (recommended)</option>
                        <option>MKV</option>
                        <option>WebM</option>
                        <option>MP3 (audio only)</option>
                    </select>
                </div>

                <!-- Options -->
                <div class="space-y-3 mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" class="w-5 h-5 rounded border-gray-300 text-indigo-600">
                        <span class="ml-3 font-medium text-gray-700">Download subtitles</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" checked class="w-5 h-5 rounded border-gray-300 text-indigo-600">
                        <span class="ml-3 font-medium text-gray-700">Embed thumbnail</span>
                    </label>
                </div>

                <!-- Download Button -->
                <button
                    @click="customDownload(); showOptions = false"
                    class="w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl touch-feedback"
                >
                    Start Download
                </button>
            </div>
        </div>
    </div>

    <script>
        function mobileApp() {
            return {
                url: '',
                currentTab: 'home',
                showOptions: false,
                showMenu: false,
                quality: 'Best',
                activeDownloads: [],
                recentDownloads: [],

                init() {
                    // Check for shared URL
                    const params = new URLSearchParams(window.location.search);
                    const sharedUrl = params.get('url') || params.get('text');
                    if (sharedUrl) {
                        this.url = sharedUrl;
                    }
                },

                async pasteFromClipboard() {
                    try {
                        const text = await navigator.clipboard.readText();
                        if (text && (text.startsWith('http://') || text.startsWith('https://'))) {
                            this.url = text;
                        }
                    } catch (err) {
                        console.error('Failed to read clipboard:', err);
                        alert('Please paste the URL manually');
                    }
                },

                quickDownload() {
                    if (!this.url) return;

                    const download = {
                        id: Date.now(),
                        title: 'Video Title Here',
                        status: 'Downloading...',
                        progress: 0,
                        speed: '0 MB/s'
                    };

                    this.activeDownloads.push(download);
                    this.simulateDownload(download);
                },

                simulateDownload(download) {
                    const interval = setInterval(() => {
                        download.progress += 5;
                        download.speed = (Math.random() * 5 + 1).toFixed(1) + ' MB/s';

                        if (download.progress >= 100) {
                            clearInterval(interval);
                            this.activeDownloads = this.activeDownloads.filter(d => d.id !== download.id);
                            this.recentDownloads.unshift({
                                id: download.id,
                                title: download.title,
                                size: '265 MB',
                                time: 'Just now',
                                url: '/download/file.mp4'
                            });
                        }
                    }, 500);
                },

                getInfo() {
                    alert('Fetching video information...');
                },

                customDownload() {
                    this.quickDownload();
                },

                pauseDownload(id) {
                    console.log('Pause download:', id);
                },

                cancelDownload(id) {
                    this.activeDownloads = this.activeDownloads.filter(d => d.id !== id);
                },

                openFile(url) {
                    window.open(url, '_blank');
                }
            }
        }
    </script>
</body>
</html>
